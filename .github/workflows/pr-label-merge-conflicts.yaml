---
name: Auto label merge conflicts

permissions:
  issues: write
  pull-requests: write

on:
  workflow_call:
  push:
    branches: [main]
  workflow_dispatch:

jobs:
  label-merge-conflicts:
    if: github.repository_owner == 'DLRSP'
    runs-on: ubuntu-latest
    continue-on-error: true
    steps:
      - name: Label merge conflicts
        id: label
        uses: pradyunsg/auto-label-merge-conflicts@v3
        with:
          CONFLICT_LABEL_NAME: "üîÄ needs rebase or merge"
          GITHUB_TOKEN: ${{ secrets.BOT_PAT || secrets.PERSONAL_TOKEN || secrets.GITHUB_TOKEN }}
        continue-on-error: true
      
      - name: Handle label error
        if: steps.label.outcome == 'failure'
        run: |
          echo "‚ö†Ô∏è  Warning: Label 'üîÄ needs rebase or merge' not found in repository"
          echo "‚ÑπÔ∏è  To fix this, add the label manually in repository settings or use the labels.yaml workflow to sync labels"
          echo "‚ÑπÔ∏è  This is a non-critical job and the workflow will continue"
